# SNMP example
#
version: 2
timeout: 2
# print empty line every 2 seconds
beacon: 2
# pull data from source 2 times per second
freq: 2
# output time, valid format values are: rfc3339, raw / timestamp
#time-format: rfc3339
# protocol
proto:
  name: snmp
  # snmp host/port
  source: 10.90.1.1:161
  community: public
  # retry attempts
  retries: 2
  # snmp version
  version: 2
# output as nd-json
output: ndjson
pull:
  - oids:
    # .* means walk oid
    - system.*
    # process the data
    process:
      # for oid = sysUpTimeInstance
      - oid: sysUpTimeInstance
        # rename to uptime, optional
        set-id: uptime
        transform:
          # divide it by 100 (get seconds)
          - func: divide
            args: [ 100 ]
          # divide again, by 86400 (get days)
          - func: divide
            args: [ 86400 ]
          # round value to zero digits after comma
          - func: round
            args: [ 0 ]
    ignore:
      # ignore this oid
      - sysContact.0
  - oids:
    # get 2 oids at once. will do GET requests for SNMPv1
    # one GETBULK for SNMPv2
    - .1.3.6.1.2.1.2.2.1.10.15
    - .1.3.6.1.2.1.2.2.1.16.15
    process:
      - oid: ifOutOctets.16
        # rename to Pub-out
        set-id: Pub-out
        transform: &if
          # instead of value itself, measure its growing speed (here - calc
          # bandwidth)
          - func: speed
          # calculate 1-second speed to avoid zero values
            args: [ 1 ]
          # multiply by 8 to get bits
          - func: multiply
            args: [ 8 ]
          # divide by 1000 to get kbits
          - func: divide
            args: [ 1000 ]
          # round the result to 1 digit after comma
          - func: round
            args: [ 1 ]
      - oid: ifInOctets.16
        set-id: Pub-in
        # use the same YAML anchor to transform the interface data
        transform: *if
